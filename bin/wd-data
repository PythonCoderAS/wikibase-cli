#!/usr/bin/env node
const program = require('../lib/program')
program.process('data')
const wdk = require('../lib/customized_wdk')(program)

const parseId = require('../lib/tolerant_id_parser')
const id = parseId(program.args[0])

if (!id) return program.help()

if (!wdk.isEntityId(id)) throw new Error('invalid entity id')

const lightGet = require('../lib/light_get')
const url = wdk.customize('getEntities', id)

lightGet(url)
.then(body => {
  const entity = body.entities && body.entities[id]
  if (entity != null) {
    return process.stdout.write(JSON.stringify(entity, null, 4) + '\n')
  } else {
    return console.log('error: ', body)
  }
})
.catch(console.log)
