#!/usr/bin/env node
const program = require('../lib/program')

program.process('data')

const parseId = require('../lib/tolerant_id_parser')
const id = parseId(program.args[0])

if (!id) return program.help()

if (!/^(Q|P)[0-9]+$/.test(id)) {
  throw new Error('invalid wikidata entity or property id')
}

const lightGet = require('../lib/light_get')
const wdk = require('../lib/customized_wdk')(program)
const url = wdk('getEntities', id)

lightGet(url)
.then(function(body) {
  const entity = body.entities && body.entities[id]
  if (entity != null) {
    return process.stdout.write(JSON.stringify(entity, null, 4) + '\n')
  } else {
    return console.log('error: ', body)
  }
})
.catch(console.log)
