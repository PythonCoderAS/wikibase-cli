#!/usr/bin/env node
const program = require('commander')
const pkg = require('../package.json')
const { red } = require('chalk')

const cmds = {
  summary: require('../metadata/summary'),
  label: require('../metadata/label'),
  description: require('../metadata/description'),
  claims: require('../metadata/claims'),
  data: require('../metadata/data'),
  revisions: require('../metadata/revisions'),
  props: require('../metadata/props'),
  id: require('../metadata/id'),
  sparql: require('../metadata/sparql'),
  query: require('../metadata/query'),
  open: require('../metadata/open'),
  coord: require('../metadata/coord'),
  'set-label': require('../metadata/set-label'),
  'set-description': require('../metadata/set-description'),
  'add-claim': require('../metadata/add-claim'),
  'update-claim': require('../metadata/update-claim'),
  'remove-claim': require('../metadata/remove-claim'),
  'add-reference': require('../metadata/add-reference'),
  config: require('../metadata/config')
}

const cmdsList = Object.keys(cmds)

program
.version(pkg.version)
.command(`summary ${cmds.summary.args}`, cmds.summary.description).alias('s')
.command(`label ${cmds.label.args}`, cmds.label.description).alias('l')
.command(`description ${cmds.description.args}`, cmds.description.description).alias('desc')
.command(`claims ${cmds.claims.args}`, cmds.claims.description).alias('c')
.command(`data ${cmds.data.args}`, cmds.data.description).alias('d')
.command(`revisions ${cmds.revisions.args}`, cmds.revisions.description).alias('r')
.command(`props ${cmds.props.args}`, cmds.props.description).alias('p')
.command(`id ${cmds.id.args}`, cmds.id.description).alias('wikiqid')
.command(`sparql ${cmds.sparql.args}`, cmds.sparql.description)
.command(`query ${cmds.query.args}`, cmds.query.description).alias('q')
.command(`open ${cmds.open.args}`, cmds.open.description).alias('o')
.command(`coord ${cmds.coord.args}`, cmds.coord.description)
.command(`set-label ${cmds['set-label'].args}`, cmds['set-label'].description).alias('sl')
.command(`set-description ${cmds['set-description'].args}`, cmds['set-description'].description).alias('sd')
.command(`add-claim ${cmds['add-claim'].args}`, cmds['add-claim'].description).alias('ac')
.command(`update-claim ${cmds['update-claim'].args}`, cmds['update-claim'].description).alias('uc')
.command(`remove-claim ${cmds['remove-claim'].args}`, cmds['remove-claim'].description).alias('rc')
.command(`add-reference ${cmds['add-reference'].args}`, cmds['add-reference'].description).alias('ar')
.command(`config ${cmds.config.args}`, cmds.config.description).alias('c')
.parse(process.argv)

const commandName = program.args[0]

if (!cmdsList.includes(commandName)) {
  console.error(red('unknown command'))
  program.help()
  process.exit(1)
}
